import{r as d,g as R,j as e,c as U,H as T,T as k,au as B,a3 as x,B as J,a2 as O,Q as C,P as G,a4 as Q,a5 as V,aW as H,p as K,aX as W,aY as X,aZ as Y,a_ as Z,q as $,aa as w,y as F,e as ee,M as te,F as v,s as se}from"./index-kAqiC6k2.js";import{I as re,l as ne}from"./lodash-Biu6pv6k.js";import{T as c,C as oe,I as ae,A as ie}from"./AdminProtectedBodyLayout-Di-Ms30s.js";import{A as E}from"./ActionIcon-B3cNPgS7.js";import{I as _}from"./IconCheck-OBFlQm04.js";import{I as ce}from"./IconSearch-Dhl_qjkm.js";import{I as le,a as de}from"./IconChevronUp-CMq190hU.js";function ue({timeout:s=2e3}={}){const[n,r]=d.useState(null),[i,a]=d.useState(!1),[u,h]=d.useState(null),p=g=>{window.clearTimeout(u),h(window.setTimeout(()=>a(!1),s)),a(g)};return{copy:g=>{"clipboard"in navigator?navigator.clipboard.writeText(g).then(()=>p(!0)).catch(b=>r(b)):r(new Error("useClipboard: navigator.clipboard is not supported"))},reset:()=>{a(!1),r(null),window.clearTimeout(u)},error:n,copied:i}}const he={timeout:1e3};function P(s){const{children:n,timeout:r,value:i,...a}=R("CopyButton",he,s),u=ue({timeout:r}),h=()=>u.copy(i);return e.jsx(e.Fragment,{children:n({copy:h,copied:u.copied,...a})})}P.displayName="@mantine/core/CopyButton";/**
 * @license @tabler/icons-react v3.21.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var M=U("outline","copy","IconCopy",[["path",{d:"M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z",key:"svg-0"}],["path",{d:"M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1",key:"svg-1"}]]);const me="_th_1w9xk_1",pe="_control_1w9xk_5",xe="_icon_1w9xk_17",N={th:me,control:pe,icon:xe};function z({children:s,reversed:n,sorted:r,onSort:i}){const a=r?n?le:de:ae;return e.jsx(c.Th,{className:N.th,children:e.jsx(Q,{onClick:i,className:N.control,children:e.jsxs(T,{justify:"space-between",children:[e.jsx(k,{fw:500,fz:"sm",children:s}),i?e.jsx(oe,{className:N.icon,children:e.jsx(a,{style:{width:x(16),height:x(16)},stroke:1.5})}):e.jsx(e.Fragment,{})]})})})}function D(s,n){const r=n.toLowerCase().trim(),i=["groupName","title","description"];return s.filter(a=>i.some(u=>a[u].toLowerCase().includes(r)))}function q(s,n){const{sortBy:r}=n;return D(r?[...s].sort((i,a)=>n.reversed?a[r].localeCompare(i[r]):i[r].localeCompare(a[r])):s,n.search)}function ge({data:s,onEdit:n,onDelete:r}){const[i,a]=d.useState(""),[u,h]=d.useState(s),[p,A]=d.useState(null),[y,g]=d.useState(!1),b=o=>{const t=o===p?!y:!1;g(t),A(o),h(q(s??[],{sortBy:o,reversed:t,search:i}))},I=o=>{const{value:t}=o.currentTarget;a(t),h(q(s??[],{sortBy:p,reversed:y,search:t}))},f=u==null?void 0:u.map(o=>e.jsxs(c.Tr,{children:[e.jsxs(c.Td,{children:[o.firstName," ",o.lastName]}),e.jsx(c.Td,{children:e.jsxs(T,{children:[e.jsx(k,{maw:100,truncate:!0,children:o.account}),e.jsx(P,{value:o.account,timeout:2e3,children:({copied:t,copy:S})=>e.jsx(B,{label:t?"Copied":"Copy",withArrow:!0,position:"right",children:e.jsx(E,{color:t?"teal":"gray",variant:"subtle",onClick:S,children:t?e.jsx(_,{style:{width:x(16)}}):e.jsx(M,{style:{width:x(16)}})})})})]})}),e.jsx(c.Td,{children:e.jsxs(T,{children:[e.jsx(k,{maw:160,truncate:!0,children:o.pwd}),e.jsx(P,{value:o.pwd,timeout:2e3,children:({copied:t,copy:S})=>e.jsx(B,{label:t?"Copied":"Copy",withArrow:!0,position:"right",children:e.jsx(E,{color:t?"teal":"gray",variant:"subtle",onClick:S,children:t?e.jsx(_,{style:{width:x(16)}}):e.jsx(M,{style:{width:x(16)}})})})})]})}),e.jsx(c.Td,{children:e.jsx(T,{children:e.jsx(k,{maw:200,truncate:!0,children:o.email})})}),e.jsx(c.Td,{children:e.jsxs(T,{gap:"sm",children:[e.jsx(J,{size:"xs",variant:"light",color:"blue",onClick:()=>n==null?void 0:n(o),children:"Edit"}),e.jsx(E,{variant:"light",color:"red",onClick:()=>r==null?void 0:r(o),children:e.jsx(re,{})})]})})]},o.id));return d.useEffect(()=>{h(s)},[s]),e.jsxs(O,{children:[e.jsx(C,{placeholder:"Search by any field",mb:"md",leftSection:e.jsx(ce,{style:{width:x(16),height:x(16)},stroke:1.5}),value:i,onChange:I}),e.jsx(G,{children:e.jsxs(c,{horizontalSpacing:"md",verticalSpacing:"xs",layout:"fixed",children:[e.jsx(c.Tbody,{children:e.jsxs(c.Tr,{children:[e.jsx(z,{sorted:p==="firstName",reversed:y,onSort:()=>b("firstName"),children:"Judge"}),e.jsx(c.Th,{w:140,children:"Account"}),e.jsx(z,{children:"Password"}),e.jsx(c.Th,{children:"Email"}),e.jsx(c.Th,{w:200,children:"Action"})]})}),e.jsx(c.Tbody,{children:f!=null&&f.length?f:e.jsx(c.Tr,{children:e.jsx(c.Td,{colSpan:3,children:e.jsx(k,{fw:500,ta:"center",children:"Nothing found"})})})})]})})]})}function Se(){var L;const{semesterId:s}=V(),{data:n,isLoading:r,isFetching:i,refetch:a}=H(s,{skip:!s,refetchOnMountOrArgChange:!0}),[u,{open:h,close:p}]=K(!1),[A,{isLoading:y}]=W(),[g,{isLoading:b}]=X(),[I,{isLoading:f}]=Y(),[o]=Z(),t=$({mode:"controlled",initialValues:{id:null,account:"",firstName:"",lastName:"",email:"",phone:"",description:""}}),S=async l=>{var m;try{l!=null&&l.id?(await g({body:l,id:l.id.toString()}).unwrap(),w.show({title:"Success",message:"Judge updated successfully",color:"green"})):(await A({body:ne.omit(l,"id"),id:s}).unwrap(),w.show({title:"Success",message:"Judge added successfully",color:"green"})),a()}catch(j){w.show({title:"Error",message:((m=j==null?void 0:j.data)==null?void 0:m.message)??"",color:"red"})}finally{t.reset(),p()}};return e.jsxs(ie,{title:"All Judges",loadingOverlay:r||i,action:{label:"Add Judge",onClick:h},action2:{label:"Download",onClick:async()=>{var l;try{await o({setupId:s,name:s}).unwrap()}catch(m){w.show({title:"Error",message:((l=m==null?void 0:m.data)==null?void 0:l.message)??"",color:"red"})}}},children:[e.jsx(ge,{data:n,onEdit:l=>{t.setValues(l),h()},onDelete:l=>{F.open({size:"sm",title:"Delete judge",children:e.jsxs(e.Fragment,{children:[e.jsxs(k,{size:"sm",children:["Are you sure you want to delete judge ",e.jsx("b",{children:l.firstName}),"?"]}),e.jsx(ee,{ta:"end",mt:"lg",children:e.jsx(J,{ta:"center",loading:f,color:"red",onClick:async()=>{var m;try{await I(l.id.toString()).unwrap(),w.show({title:"Success",message:"Judge deleted successfully",color:"red"}),a()}catch(j){w.show({title:"Error",message:((m=j==null?void 0:j.data)==null?void 0:m.message)??"",color:"red"})}finally{F.closeAll()}},children:"Delete"})})]})})}}),e.jsx(te,{opened:u,onClose:()=>{t.reset(),p()},title:(L=t.values)!=null&&L.id?"Edit judge":"Add judge",size:"lg",children:e.jsx("form",{onSubmit:t.onSubmit(S),children:e.jsxs(v,{direction:"column",gap:"sm",children:[d.createElement(C,{...t.getInputProps("account"),label:"Username",withAsterisk:!0,placeholder:"Enter username",key:t.key("account"),required:!0}),e.jsxs(v,{gap:"sm",children:[d.createElement(C,{flex:1,...t.getInputProps("firstName"),label:"First Name",withAsterisk:!0,placeholder:"Enter first name",key:t.key("firstName"),required:!0}),d.createElement(C,{flex:1,...t.getInputProps("lastName"),label:"Last Name",withAsterisk:!0,placeholder:"Enter last name",key:t.key("lastName"),required:!0})]}),e.jsxs(v,{gap:"sm",children:[d.createElement(C,{flex:1,...t.getInputProps("email"),label:"Email",type:"email",withAsterisk:!0,key:t.key("email"),required:!0}),d.createElement(C,{flex:1,...t.getInputProps("phone"),label:"Phone",type:"tel",withAsterisk:!0,key:t.key("phone")})]}),d.createElement(se,{...t.getInputProps("description"),label:"Description",key:t.key("description")}),e.jsx(J,{type:"submit",size:"md",mt:"md",loading:y||b,children:"Submit"})]})})})]})}export{Se as default};
