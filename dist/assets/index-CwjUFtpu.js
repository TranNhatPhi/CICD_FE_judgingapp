import{r as P,h as W,j as e,e as A,ab as Ye,n as U,ac as he,ad as Ne,f as V,g as G,a4 as Ie,m as se,_ as ge,ae as Ze,k as _e,af as es,ag as ss,o as pe,ah as ts,ai as os,aj as ns,i as rs,b as it,ak as dt,K as ut,al as ht,l as pt,am as as,an as mt,ao as gt,ap as xt,aq as ft,a0 as jt,ar as H,as as yt,c as bt,a5 as ls,a6 as vt,q as St,M as cs,at as is,F as J,T as D,P as xe,B as fe,au as ds,a2 as us,Q as hs,a3 as R,H as ps,av as Ct,aw as kt,ax as Pt,ay as wt,az as _t,aA as Nt,aB as It,aC as Tt,aD as Ot,aa as ue}from"./index-CMJNtPD3.js";import{T as v,C as ms,I as gs,A as Rt}from"./AdminProtectedBodyLayout-BNX7hyK0.js";import{I as xs}from"./IconSearch-Cm5b9_BS.js";import{I as fs,a as js}from"./IconChevronUp-D8c7NHdB.js";import{T as Z,I as $t}from"./IconJoinRound-D7UBqywU.js";var ys={root:"m_5f75b09e",body:"m_5f6e695e",labelWrapper:"m_d3ea56bb",label:"m_8ee546b8",description:"m_328f68c0",error:"m_8e8a99cc"};const zt=ys,bs=P.forwardRef(({__staticSelector:o,__stylesApiProps:t,className:s,classNames:l,styles:r,unstyled:c,children:a,label:n,description:f,id:d,disabled:p,error:j,size:m,labelPosition:i="left",bodyElement:u="div",labelElement:g="label",variant:y,style:h,vars:x,mod:S,...C},I)=>{const w=W({name:o,props:t,className:s,style:h,classes:ys,classNames:l,styles:r,unstyled:c});return e.jsx(A,{...w("root"),ref:I,__vars:{"--label-fz":Ye(m),"--label-lh":U(m,"label-lh")},mod:[{"label-position":i},S],variant:y,size:m,...C,children:e.jsxs(A,{component:u,htmlFor:u==="label"?d:void 0,...w("body"),children:[a,e.jsxs("div",{...w("labelWrapper"),"data-disabled":p||void 0,children:[n&&e.jsx(A,{component:g,htmlFor:g==="label"?d:void 0,...w("label"),"data-disabled":p||void 0,children:n}),f&&e.jsx(he.Description,{size:m,__inheritStyles:!1,...w("description"),children:f}),j&&typeof j!="boolean"&&e.jsx(he.Error,{size:m,__inheritStyles:!1,...w("error"),children:j})]})]})})});bs.displayName="@mantine/core/InlineInput";const vs=P.createContext(null),Lt=vs.Provider,Ss=()=>P.useContext(vs),[Mt,At]=Ne();var Cs={card:"m_26775b0a"};const Dt={withBorder:!0},Vt=se((o,{radius:t})=>({card:{"--card-radius":ge(t)}})),Te=V((o,t)=>{const s=G("CheckboxCard",Dt,o),{classNames:l,className:r,style:c,styles:a,unstyled:n,vars:f,checked:d,mod:p,withBorder:j,value:m,onClick:i,...u}=s,g=W({name:"CheckboxCard",classes:Cs,props:s,className:r,style:c,classNames:l,styles:a,unstyled:n,vars:f,varsResolver:Vt,rootSelector:"card"}),y=Ss(),h=typeof d=="boolean"?d:(y==null?void 0:y.value.includes(m||""))||!1;return e.jsx(Mt,{value:{checked:h},children:e.jsx(Ie,{ref:t,mod:[{"with-border":j,checked:h},p],...g("card"),...u,role:"checkbox","aria-checked":h,onClick:x=>{i==null||i(x),y==null||y.onChange(m||"")}})})});Te.displayName="@mantine/core/CheckboxCard";Te.classes=Cs;function Gt({children:o,role:t}){const s=Ze();return s?e.jsx("div",{role:t,"aria-labelledby":s.labelId,"aria-describedby":s.describedBy,children:o}):e.jsx(e.Fragment,{children:o})}const Ft={},Oe=V((o,t)=>{const{value:s,defaultValue:l,onChange:r,size:c,wrapperProps:a,children:n,readOnly:f,...d}=G("CheckboxGroup",Ft,o),[p,j]=_e({value:s,defaultValue:l,finalValue:[],onChange:r}),m=i=>{const u=typeof i=="string"?i:i.currentTarget.value;!f&&j(p.includes(u)?p.filter(g=>g!==u):[...p,u])};return e.jsx(Lt,{value:{value:p,onChange:m,size:c},children:e.jsx(he.Wrapper,{size:c,ref:t,...a,...d,labelElement:"div",__staticSelector:"CheckboxGroup",children:e.jsx(Gt,{role:"group",children:n})})})});Oe.classes=he.Wrapper.classes;Oe.displayName="@mantine/core/CheckboxGroup";var ks={indicator:"m_5e5256ee",icon:"m_1b1c543a","indicator--outline":"m_76e20374"};const Et={icon:es},Bt=se((o,{radius:t,color:s,size:l,iconColor:r,variant:c,autoContrast:a})=>{const n=ss({color:s||o.primaryColor,theme:o}),f=n.isThemeColor&&n.shade===void 0?`var(--mantine-color-${n.color}-outline)`:n.color;return{indicator:{"--checkbox-size":U(l,"checkbox-size"),"--checkbox-radius":t===void 0?void 0:ge(t),"--checkbox-color":c==="outline"?f:pe(s,o),"--checkbox-icon-color":r?pe(r,o):ts(a,o)?os({color:s,theme:o,autoContrast:a}):void 0}}}),Re=V((o,t)=>{const s=G("CheckboxIndicator",Et,o),{classNames:l,className:r,style:c,styles:a,unstyled:n,vars:f,icon:d,indeterminate:p,radius:j,color:m,iconColor:i,autoContrast:u,checked:g,mod:y,variant:h,disabled:x,...S}=s,C=d,I=W({name:"CheckboxIndicator",classes:ks,props:s,className:r,style:c,classNames:l,styles:a,unstyled:n,vars:f,varsResolver:Bt,rootSelector:"indicator"}),w=At(),L=typeof g=="boolean"||typeof p=="boolean"?g||p:(w==null?void 0:w.checked)||!1;return e.jsx(A,{ref:t,...I("indicator",{variant:h}),variant:h,mod:[{checked:L,disabled:x},y],...S,children:e.jsx(C,{indeterminate:p,...I("icon")})})});Re.displayName="@mantine/core/CheckboxIndicator";Re.classes=ks;var Ps={root:"m_bf2d988c",inner:"m_26062bec",input:"m_26063560",icon:"m_bf295423","input--outline":"m_215c4542"};const Jt={labelPosition:"right",icon:es},Wt=se((o,{radius:t,color:s,size:l,iconColor:r,variant:c,autoContrast:a})=>{const n=ss({color:s||o.primaryColor,theme:o}),f=n.isThemeColor&&n.shade===void 0?`var(--mantine-color-${n.color}-outline)`:n.color;return{root:{"--checkbox-size":U(l,"checkbox-size"),"--checkbox-radius":t===void 0?void 0:ge(t),"--checkbox-color":c==="outline"?f:pe(s,o),"--checkbox-icon-color":r?pe(r,o):ts(a,o)?os({color:s,theme:o,autoContrast:a}):void 0}}}),K=V((o,t)=>{const s=G("Checkbox",Jt,o),{classNames:l,className:r,style:c,styles:a,unstyled:n,vars:f,color:d,label:p,id:j,size:m,radius:i,wrapperProps:u,checked:g,labelPosition:y,description:h,error:x,disabled:S,variant:C,indeterminate:I,icon:w,rootRef:L,iconColor:M,onChange:$,autoContrast:te,mod:Q,...X}=s,b=Ss(),_=m||(b==null?void 0:b.size),T=w,N=W({name:"Checkbox",props:s,classes:Ps,className:r,style:c,classNames:l,styles:a,unstyled:n,vars:f,varsResolver:Wt}),{styleProps:F,rest:q}=ns(X),le=rs(j),ce=b?{checked:b.value.includes(q.value),onChange:ie=>{b.onChange(ie),$==null||$(ie)}}:{};return e.jsx(bs,{...N("root"),__staticSelector:"Checkbox",__stylesApiProps:s,id:le,size:_,labelPosition:y,label:p,description:h,error:x,disabled:S,classNames:l,styles:a,unstyled:n,"data-checked":ce.checked||g||void 0,variant:C,ref:L,mod:Q,...F,...u,children:e.jsxs(A,{...N("inner"),mod:{"data-label-position":y},children:[e.jsx(A,{component:"input",id:le,ref:t,checked:g,disabled:S,mod:{error:!!x,indeterminate:I},...N("input",{focusable:!0,variant:C}),onChange:$,...q,...ce,type:"checkbox"}),e.jsx(T,{indeterminate:I,...N("icon")})]})})});K.classes={...Ps,...zt};K.displayName="@mantine/core/Checkbox";K.Group=Oe;K.Indicator=Re;K.Card=Te;const[qt,Ht]=it("List component was not found in tree");var $e={root:"m_abbac491",item:"m_abb6bec2",itemWrapper:"m_75cd9f71",itemIcon:"m_60f83e5b"};const Ut={},ze=V((o,t)=>{const s=G("ListItem",Ut,o),{classNames:l,className:r,style:c,styles:a,vars:n,icon:f,children:d,mod:p,...j}=s,m=Ht(),i=f||m.icon,u={classNames:l,styles:a};return e.jsx(A,{...m.getStyles("item",{...u,className:r,style:c}),component:"li",mod:[{"with-icon":!!i,centered:m.center},p],ref:t,...j,children:e.jsxs("div",{...m.getStyles("itemWrapper",u),children:[i&&e.jsx("span",{...m.getStyles("itemIcon",u),children:i}),e.jsx("span",{...m.getStyles("itemLabel",u),children:d})]})})});ze.classes=$e;ze.displayName="@mantine/core/ListItem";const Kt={type:"unordered"},Qt=se((o,{size:t,spacing:s})=>({root:{"--list-fz":Ye(t),"--list-lh":dt(t),"--list-spacing":ut(s)}})),re=V((o,t)=>{const s=G("List",Kt,o),{classNames:l,className:r,style:c,styles:a,unstyled:n,vars:f,children:d,type:p,withPadding:j,icon:m,spacing:i,center:u,listStyleType:g,mod:y,...h}=s,x=W({name:"List",classes:$e,props:s,className:r,style:c,classNames:l,styles:a,unstyled:n,vars:f,varsResolver:Qt});return e.jsx(qt,{value:{center:u,icon:m,getStyles:x},children:e.jsx(A,{...x("root",{style:{listStyleType:g}}),component:p==="unordered"?"ul":"ol",mod:[{"with-padding":j},y],ref:t,...h,children:d})})});re.classes=$e;re.displayName="@mantine/core/List";re.Item=ze;const[Xt,Le]=Ne(),[Yt,Zt]=Ne();var je={root:"m_7cda1cd6","root--default":"m_44da308b","root--contrast":"m_e3a01f8",label:"m_1e0e6180",remove:"m_ae386778",group:"m_1dcfd90b"};const eo={},so=se((o,{gap:t},{size:s})=>({group:{"--pg-gap":t!==void 0?U(t):U(s,"pg-gap")}})),Me=V((o,t)=>{const s=G("PillGroup",eo,o),{classNames:l,className:r,style:c,styles:a,unstyled:n,vars:f,size:d,disabled:p,...j}=s,m=Le(),i=(m==null?void 0:m.size)||d||void 0,u=W({name:"PillGroup",classes:je,props:s,className:r,style:c,classNames:l,styles:a,unstyled:n,vars:f,varsResolver:so,stylesCtx:{size:i},rootSelector:"group"});return e.jsx(Yt,{value:{size:i,disabled:p},children:e.jsx(A,{ref:t,size:i,...u("group"),...j})})});Me.classes=je;Me.displayName="@mantine/core/PillGroup";const to={variant:"default"},oo=se((o,{radius:t},{size:s})=>({root:{"--pill-fz":U(s,"pill-fz"),"--pill-height":U(s,"pill-height"),"--pill-radius":t===void 0?void 0:ge(t)}})),ae=V((o,t)=>{const s=G("Pill",to,o),{classNames:l,className:r,style:c,styles:a,unstyled:n,vars:f,variant:d,children:p,withRemoveButton:j,onRemove:m,removeButtonProps:i,radius:u,size:g,disabled:y,mod:h,...x}=s,S=Zt(),C=Le(),I=g||(S==null?void 0:S.size)||void 0,w=(C==null?void 0:C.variant)==="filled"?"contrast":d||"default",L=W({name:"Pill",classes:je,props:s,className:r,style:c,classNames:l,styles:a,unstyled:n,vars:f,varsResolver:oo,stylesCtx:{size:I}});return e.jsxs(A,{component:"span",ref:t,variant:w,size:I,...L("root",{variant:w}),mod:[{"with-remove":j&&!y,disabled:y||(S==null?void 0:S.disabled)},h],...x,children:[e.jsx("span",{...L("label"),children:p}),j&&e.jsx(ht,{variant:"transparent",radius:u,tabIndex:-1,"aria-hidden":!0,unstyled:n,...i,...L("remove",{className:i==null?void 0:i.className,style:i==null?void 0:i.style}),onMouseDown:M=>{var $;M.preventDefault(),M.stopPropagation(),($=i==null?void 0:i.onMouseDown)==null||$.call(i,M)},onClick:M=>{var $;M.stopPropagation(),m==null||m(),($=i==null?void 0:i.onClick)==null||$.call(i,M)}})]})});ae.classes=je;ae.displayName="@mantine/core/Pill";ae.Group=Me;var ws={field:"m_45c4369d"};const no={type:"visible"},Ae=V((o,t)=>{const s=G("PillsInputField",no,o),{classNames:l,className:r,style:c,styles:a,unstyled:n,vars:f,type:d,disabled:p,id:j,pointer:m,mod:i,...u}=s,g=Le(),y=Ze(),h=W({name:"PillsInputField",classes:ws,props:s,className:r,style:c,classNames:l,styles:a,unstyled:n,rootSelector:"field"}),x=p||(g==null?void 0:g.disabled);return e.jsx(A,{component:"input",ref:pt(t,g==null?void 0:g.fieldRef),"data-type":d,disabled:x,mod:[{disabled:x,pointer:m},i],...h("field"),...u,id:(y==null?void 0:y.inputId)||j,"aria-invalid":g==null?void 0:g.hasError,"aria-describedby":y==null?void 0:y.describedBy,type:"text",onMouseDown:S=>!m&&S.stopPropagation()})});Ae.classes=ws;Ae.displayName="@mantine/core/PillsInputField";const ro={},me=V((o,t)=>{const s=G("PillsInput",ro,o),{children:l,onMouseDown:r,onClick:c,size:a,disabled:n,__staticSelector:f,error:d,variant:p,...j}=s,m=P.useRef();return e.jsx(Xt,{value:{fieldRef:m,size:a,disabled:n,hasError:!!d,variant:p},children:e.jsx(as,{size:a,error:d,variant:p,component:"div",ref:t,onMouseDown:i=>{var u;i.preventDefault(),r==null||r(i),(u=m.current)==null||u.focus()},onClick:i=>{var u;i.preventDefault(),c==null||c(i),(u=m.current)==null||u.focus()},...j,multiline:!0,disabled:n,__staticSelector:f||"PillsInput",withAria:!1,children:l})})});me.displayName="@mantine/core/PillsInput";me.Field=Ae;function ao({data:o,value:t}){const s=t.map(r=>r.trim().toLowerCase());return o.reduce((r,c)=>(mt(c)?r.push({group:c.group,items:c.items.filter(a=>s.indexOf(a.value.toLowerCase().trim())===-1)}):s.indexOf(c.value.toLowerCase().trim())===-1&&r.push(c),r),[])}const lo={maxValues:1/0,withCheckIcon:!0,checkIconPosition:"left",hiddenInputValuesDivider:","},De=V((o,t)=>{const s=G("MultiSelect",lo,o),{classNames:l,className:r,style:c,styles:a,unstyled:n,vars:f,size:d,value:p,defaultValue:j,onChange:m,onKeyDown:i,variant:u,data:g,dropdownOpened:y,defaultDropdownOpened:h,onDropdownOpen:x,onDropdownClose:S,selectFirstOptionOnChange:C,onOptionSubmit:I,comboboxProps:w,filter:L,limit:M,withScrollArea:$,maxDropdownHeight:te,searchValue:Q,defaultSearchValue:X,onSearchChange:b,readOnly:_,disabled:T,onFocus:N,onBlur:F,onPaste:q,radius:le,rightSection:ce,rightSectionWidth:ie,rightSectionPointerEvents:Ve,rightSectionProps:_s,leftSection:Ns,leftSectionWidth:Is,leftSectionPointerEvents:Ts,leftSectionProps:Os,inputContainer:Rs,inputWrapperOrder:$s,withAsterisk:zs,labelProps:Ls,descriptionProps:Ms,errorProps:As,wrapperProps:Ds,description:Vs,label:ye,error:Ge,maxValues:Gs,searchable:E,nothingFoundMessage:Fe,withCheckIcon:Fs,checkIconPosition:Es,hidePickedOptions:Bs,withErrorStyles:Js,name:Ws,form:qs,id:Hs,clearable:Us,clearButtonProps:Ks,hiddenInputProps:Qs,placeholder:Ee,hiddenInputValuesDivider:Xs,required:Ys,mod:Zs,renderOption:et,onRemove:B,onClear:be,scrollAreaProps:st,...Be}=s,ve=rs(Hs),Se=gt(g),Y=xt(Se),z=ft({opened:y,defaultOpened:h,onDropdownOpen:x,onDropdownClose:()=>{S==null||S(),z.resetSelectedOption()}}),{styleProps:tt,rest:{type:jo,autoComplete:ot,...nt}}=ns(Be),[O,oe]=_e({value:p,defaultValue:j,finalValue:[],onChange:m}),[Ce,de]=_e({value:Q,defaultValue:X,finalValue:"",onChange:b}),ke=W({name:"MultiSelect",classes:{},props:s,classNames:l,styles:a,unstyled:n}),{resolvedClassNames:Je,resolvedStyles:We}=jt({props:s,styles:a,classNames:l}),rt=k=>{i==null||i(k),k.key===" "&&!E&&(k.preventDefault(),z.toggleDropdown()),k.key==="Backspace"&&Ce.length===0&&O.length>0&&(B==null||B(O[O.length-1]),oe(O.slice(0,O.length-1)))},at=O.map((k,we)=>{var qe,He;return e.jsx(ae,{withRemoveButton:!_&&!((qe=Y[k])!=null&&qe.disabled),onRemove:()=>{oe(O.filter(ct=>k!==ct)),B==null||B(k)},unstyled:n,disabled:T,...ke("pill"),children:((He=Y[k])==null?void 0:He.label)||k},`${k}-${we}`)});P.useEffect(()=>{C&&z.selectFirstOption()},[C,O]);const Pe=Us&&O.length>0&&!T&&!_&&e.jsx(H.ClearButton,{size:d,...Ks,onClear:()=>{be==null||be(),oe([]),de("")}}),lt=ao({data:Se,value:O});return e.jsxs(e.Fragment,{children:[e.jsxs(H,{store:z,classNames:Je,styles:We,unstyled:n,size:d,readOnly:_,__staticSelector:"MultiSelect",onOptionSubmit:k=>{I==null||I(k),de(""),z.updateSelectedOptionIndex("selected"),O.includes(Y[k].value)?(oe(O.filter(we=>we!==Y[k].value)),B==null||B(Y[k].value)):O.length<Gs&&oe([...O,Y[k].value])},...w,children:[e.jsx(H.DropdownTarget,{children:e.jsx(me,{...tt,__staticSelector:"MultiSelect",classNames:Je,styles:We,unstyled:n,size:d,className:r,style:c,variant:u,disabled:T,radius:le,rightSection:ce||Pe||e.jsx(H.Chevron,{size:d,error:Ge,unstyled:n}),rightSectionPointerEvents:Ve||(Pe?"all":"none"),rightSectionWidth:ie,rightSectionProps:_s,leftSection:Ns,leftSectionWidth:Is,leftSectionPointerEvents:Ts,leftSectionProps:Os,inputContainer:Rs,inputWrapperOrder:$s,withAsterisk:zs,labelProps:Ls,descriptionProps:Ms,errorProps:As,wrapperProps:Ds,description:Vs,label:ye,error:Ge,multiline:!0,withErrorStyles:Js,__stylesApiProps:{...s,rightSectionPointerEvents:Ve||(Pe?"all":"none"),multiline:!0},pointer:!E,onClick:()=>E?z.openDropdown():z.toggleDropdown(),"data-expanded":z.dropdownOpened||void 0,id:ve,required:Ys,mod:Zs,children:e.jsxs(ae.Group,{disabled:T,unstyled:n,...ke("pillsList"),children:[at,e.jsx(H.EventsTarget,{autoComplete:ot,children:e.jsx(me.Field,{...nt,ref:t,id:ve,placeholder:Ee,type:!E&&!Ee?"hidden":"visible",...ke("inputField"),unstyled:n,onFocus:k=>{N==null||N(k),E&&z.openDropdown()},onBlur:k=>{F==null||F(k),z.closeDropdown(),de("")},onKeyDown:rt,value:Ce,onChange:k=>{de(k.currentTarget.value),E&&z.openDropdown(),C&&z.selectFirstOption()},disabled:T,readOnly:_||!E,pointer:!E})})]})})}),e.jsx(yt,{data:Bs?lt:Se,hidden:_||T,filter:L,search:Ce,limit:M,hiddenWhenEmpty:!Fe,withScrollArea:$,maxDropdownHeight:te,filterOptions:E,value:O,checkIconPosition:Es,withCheckIcon:Fs,nothingFoundMessage:Fe,unstyled:n,labelId:ye?`${ve}-label`:void 0,"aria-label":ye?void 0:Be["aria-label"],renderOption:et,scrollAreaProps:st})]}),e.jsx(H.HiddenInput,{name:Ws,valuesDivider:Xs,value:O,form:qs,disabled:T,...Qs})]})});De.classes={...as.classes,...H.classes};De.displayName="@mantine/core/MultiSelect";/**
 * @license @tabler/icons-react v3.21.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var co=bt("outline","users-group","IconUsersGroup",[["path",{d:"M10 13a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-0"}],["path",{d:"M8 21v-1a2 2 0 0 1 2 -2h4a2 2 0 0 1 2 2v1",key:"svg-1"}],["path",{d:"M15 5a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-2"}],["path",{d:"M17 10h2a2 2 0 0 1 2 2v1",key:"svg-3"}],["path",{d:"M5 5a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-4"}],["path",{d:"M3 13v-1a2 2 0 0 1 2 -2h2",key:"svg-5"}]]);const io=({isOpen:o,onClose:t,judges:s,onSubmit:l,loading:r,projectIds:c})=>{const{semesterId:a}=ls(),{data:n,isLoading:f}=vt(a,{skip:!a,refetchOnMountOrArgChange:!0}),d=St({mode:"uncontrolled",initialValues:{projects:c}}),p=j=>{l(j.projects)};return P.useEffect(()=>{d.isDirty("projects")||d.setValues({projects:c})},[c]),e.jsx(cs,{title:"Allocate Judges",opened:o,onClose:()=>{d.setValues({projects:[]}),d.setDirty({projects:!1}),t()},overlayProps:{backgroundOpacity:.55,blur:3},children:e.jsx(is,{children:e.jsx("form",{onSubmit:d.onSubmit(p),children:e.jsxs(J,{direction:"column",gap:"md",children:[e.jsxs(J,{direction:"column",children:[e.jsx(D,{size:"lg",fw:500,children:"Judges"}),e.jsx(J,{wrap:"wrap",gap:"md",children:s==null?void 0:s.map(j=>e.jsx(xe,{p:"md",radius:"md",withBorder:!0,children:e.jsx(D,{size:"sm",fw:500,children:j.name})},j.name))})]}),P.createElement(De,{label:"Available projects",placeholder:"select project(s) here",searchable:!0,data:(n==null?void 0:n.map(j=>({value:j.id.toString(),label:`${j.groupName} - ${j.title}`})))??[],nothingFoundMessage:"No projects found...",...d.getInputProps("projects"),key:d.key("projects")}),e.jsx(fe,{loading:f||r,type:"submit",children:"Submit"})]})})})})},uo=({isOpen:o,onClose:t,projects:s,onSubmit:l,loading:r})=>e.jsx(cs,{title:"Confirm projects into round 2",opened:o,onClose:()=>{t()},overlayProps:{backgroundOpacity:.55,blur:3},children:e.jsx(is,{children:e.jsxs(J,{direction:"column",gap:"md",children:[e.jsxs(J,{direction:"column",children:[e.jsx(D,{size:"lg",fw:500,children:"Projects"}),e.jsx(J,{wrap:"wrap",gap:"md",children:s==null?void 0:s.map(c=>e.jsxs(xe,{p:"md",radius:"md",withBorder:!0,children:[e.jsx(D,{size:"sm",fw:500,children:c.title}),e.jsx(D,{size:"sm",c:"gray",children:c.groupName})]},c.title))})]}),e.jsx(fe,{onClick:l,loading:r,children:"Submit"})]})})}),ho="_th_1w9xk_1",po="_control_1w9xk_5",mo="_icon_1w9xk_17",ee={th:ho,control:po,icon:mo};function go({children:o,reversed:t,sorted:s,onSort:l}){const r=s?t?fs:js:gs;return e.jsx(v.Th,{className:ee.th,style:{width:"80px"},children:e.jsx(Ie,{onClick:l,className:ee.control,children:e.jsxs(ps,{justify:"space-between",children:[e.jsx(D,{fw:500,fz:"sm",children:o}),l?e.jsx(ms,{className:ee.icon,children:e.jsx(r,{style:{width:R(16),height:R(16)},stroke:1.5})}):e.jsx(e.Fragment,{})]})})})}function Ue(o,t){const s=t.toLowerCase().trim(),l=["firstName"];return o.filter(r=>l.some(c=>r.judge[c].toLowerCase().includes(s)))}function Ke(o,t){const{sortBy:s}=t;return Ue(s?[...o].sort((l,r)=>t.reversed?r.judge[s].localeCompare(l.judge[s]):l.judge[s].localeCompare(r.judge[s])):o,t.search)}function xo({data:o,setSelection:t,onHandleAllocate:s}){const[l,r]=P.useState(""),[c,a]=P.useState(o),[n,f]=P.useState(null),[d,p]=P.useState(!1),j=u=>{const g=u===n?!d:!1;p(g),f(u),a(Ke(o??[],{sortBy:u,reversed:g,search:l}))},m=u=>{const{value:g}=u.currentTarget;r(g),a(Ke(o??[],{sortBy:n,reversed:d,search:g}))},i=c==null?void 0:c.map(u=>e.jsxs(v.Tr,{children:[e.jsxs(v.Td,{children:[u.judge.firstName," ",u.judge.lastName]}),e.jsx(v.Td,{children:u.numberOfProjects}),e.jsx(v.Td,{children:e.jsx(re,{children:u.projects.map(g=>e.jsxs(re.Item,{children:[g.title," ",g.groupName]},g.id))})}),e.jsx(v.Td,{children:e.jsx(ds,{label:"Start allocating projects to this judge",children:e.jsx(fe,{onClick:()=>{t([u.judge.id]),s()},children:"Allocate projects"})})})]},u.judge.id));return P.useEffect(()=>{a(o)},[o]),e.jsxs(us,{children:[e.jsx(J,{gap:"sm",align:"center",mb:"md",children:e.jsx(hs,{flex:1,placeholder:"Search by any field",leftSection:e.jsx(xs,{style:{width:R(16),height:R(16)},stroke:1.5}),value:l,onChange:m})}),e.jsx(xe,{children:e.jsxs(v,{horizontalSpacing:"md",verticalSpacing:"md",layout:"fixed",children:[e.jsx(v.Tbody,{children:e.jsxs(v.Tr,{children:[e.jsx(go,{sorted:n==="firstName",reversed:d,onSort:()=>j("firstName"),children:"Judge"}),e.jsx(v.Th,{style:{width:R(60)},children:"Number of projects"}),e.jsx(v.Th,{style:{width:R(140)},children:"Projects"}),e.jsx(v.Th,{style:{width:R(60)},children:"Action"})]})}),e.jsx(v.Tbody,{children:i!=null&&i.length?i:e.jsx(v.Tr,{children:e.jsx(v.Td,{colSpan:3,children:e.jsx(D,{fw:500,ta:"center",children:"Nothing found"})})})})]})})]})}function ne({children:o,reversed:t,sorted:s,onSort:l,...r}){const c=s?t?fs:js:gs;return e.jsx(v.Th,{...r,className:ee.th,children:e.jsx(Ie,{onClick:l,className:ee.control,children:e.jsxs(ps,{justify:"space-between",children:[e.jsx(D,{fw:500,fz:"sm",children:o}),l?e.jsx(ms,{className:ee.icon,children:e.jsx(c,{style:{width:R(16),height:R(16)},stroke:1.5})}):e.jsx(e.Fragment,{})]})})})}function Qe(o,t){const s=t.toLowerCase().trim(),l=["groupName","title","description"];return o.filter(r=>l.some(c=>{var a;return((a=r==null?void 0:r.project)==null?void 0:a[c]).toLowerCase().includes(s)}))}function Xe(o,t){const{sortBy:s}=t;return Qe(s?[...o].sort((l,r)=>{var c,a,n,f;return t.reversed?((c=r==null?void 0:r.project)==null?void 0:c[s]).localeCompare((a=l==null?void 0:l.project)==null?void 0:a[s]):((n=l==null?void 0:l.project)==null?void 0:n[s]).localeCompare((f=r==null?void 0:r.project)==null?void 0:f[s])}):o,t.search)}function fo({data:o,selection:t,setSelection:s,onHandleAllocate:l}){const[r,c]=P.useState(""),[a,n]=P.useState(o),[f,d]=P.useState(null),[p,j]=P.useState(!1),m=h=>{const x=h===f?!p:!1;j(x),d(h),n(Xe(o??[],{sortBy:h,reversed:x,search:r}))},i=h=>{const{value:x}=h.currentTarget;c(x),n(Xe(o??[],{sortBy:f,reversed:p,search:x}))},u=h=>s(x=>x!=null&&x.includes(h)?x==null?void 0:x.filter(S=>S!==h):[...x,h]),g=()=>s(h=>(h==null?void 0:h.length)===(a==null?void 0:a.length)?[]:(a==null?void 0:a.map(x=>x.project.id))??[]),y=a==null?void 0:a.map(h=>{var x,S;return e.jsxs(v.Tr,{children:[e.jsx(v.Td,{children:e.jsx(K,{checked:t.includes(h.project.id),onChange:()=>u(h.project.id),size:"lg"})}),e.jsx(v.Td,{children:h.project.averageMarkV1}),e.jsx(v.Td,{children:e.jsxs(J,{direction:"column",gap:"xs",children:[e.jsx(D,{size:"md",children:h.project.title}),e.jsx(D,{size:"sm",c:"gray",children:h.project.groupName})]})}),e.jsx(v.Td,{children:(x=h.judgesAssigned)==null?void 0:x.map(C=>`${C.firstName} ${C.lastName}`).join(", ")}),e.jsx(v.Td,{children:(S=h.judgesMarked)==null?void 0:S.map(C=>`${C.firstName} ${C.lastName} (${C.mark})`).join(", ")}),e.jsx(v.Td,{children:h.project.description})]},h.project.id)});return P.useEffect(()=>{n(o)},[o]),e.jsxs(us,{children:[e.jsxs(J,{gap:"sm",align:"center",mb:"md",children:[e.jsx(hs,{flex:1,placeholder:"Search by any field",leftSection:e.jsx(xs,{style:{width:R(16),height:R(16)},stroke:1.5}),value:r,onChange:i}),e.jsx(ds,{label:"Select 5 projects for round 2",children:e.jsx(fe,{disabled:(t==null?void 0:t.length)!=5,onClick:l,children:"Confirm finalists (5 projects)"})})]}),e.jsx(xe,{children:e.jsxs(v,{horizontalSpacing:"md",verticalSpacing:"xs",layout:"fixed",children:[e.jsx(v.Tbody,{children:e.jsxs(v.Tr,{children:[e.jsx(v.Th,{style:{width:R(50)},children:e.jsx(K,{size:"lg",onChange:g,checked:t.length===(a==null?void 0:a.length),indeterminate:t.length>0&&t.length!==(a==null?void 0:a.length)})}),e.jsx(ne,{style:{width:R(80)},ta:"center",children:"Scores"}),e.jsx(ne,{sorted:f==="title",reversed:p,onSort:()=>m("title"),children:"Projects"}),e.jsx(ne,{children:"Judges"}),e.jsx(ne,{children:"Marked by"}),e.jsx(ne,{children:"Description"})]})}),e.jsx(v.Tbody,{children:y!=null&&y.length?y:e.jsx(v.Tr,{children:e.jsx(v.Td,{colSpan:3,children:e.jsx(D,{fw:500,ta:"center",children:"Nothing found"})})})})]})})]})}const ko=()=>{var te,Q,X;const o={width:R(12),height:R(12)},[t,s]=Ct(),l=kt(),r="https://nhatphi-nginx.io.vn:8888/api/ws";P.useEffect(()=>{s({tab:(t==null?void 0:t.get("tab"))??"projects"})},[]);const[c,a]=P.useState(!1),[n,f]=P.useState([]),{semesterId:d}=ls(),{data:p,isLoading:j,refetch:m}=Pt(d,{skip:!d,refetchOnMountOrArgChange:!0}),[i,{isLoading:u}]=wt(),g=async b=>{var T;const _=n==null?void 0:n.map(N=>({judgeId:Number(N),projectIds:b==null?void 0:b.map(F=>Number(F))}));try{await i({id:d,requests:_}).unwrap(),a(!1),ue.show({title:"Success",message:"Judges assigned successfully",color:"green"}),m()}catch(N){console.log("error",N),a(!1),ue.show({title:"Error",message:((T=N==null?void 0:N.data)==null?void 0:T.message)??"",color:"red"})}},[y,h]=P.useState(!1),[x,S]=P.useState([]),{data:C,isLoading:I,refetch:w}=_t(d,{skip:!d,refetchOnMountOrArgChange:!0});P.useEffect(()=>{const b=new Nt(r),_=new It({webSocketFactory:()=>b,debug:T=>console.log(T),reconnectDelay:5e3,heartbeatIncoming:4e3,heartbeatOutgoing:4e3});return _.onConnect=()=>{console.log("WebSocket connected"),_.subscribe("/notifications",T=>{const N=JSON.parse(T.body??"{}"),{content:F}=N;if(F){const q=JSON.parse(F??"{}");console.log("result",q),q&&(l(Tt(q)),w())}console.log(N)})},_.activate(),()=>{_.deactivate()}},[w]);const[L,{isLoading:M}]=Ot(),$=async()=>{var b;try{await L({id:d,body:x.map(_=>Number(_))}).unwrap(),h(!1),ue.show({title:"Success",message:"Projects confirmed to round 2 successfully",color:"green"})}catch(_){console.log("err",_),h(!1),ue.show({title:"Error",message:((b=_==null?void 0:_.data)==null?void 0:b.message)??"",color:"red"})}finally{h(!1),w(),S([])}};return e.jsx(Rt,{title:"Round 1",loadingOverlay:j||I,children:e.jsxs(Z,{value:t.get("tab")||"projects",onChange:b=>{s({tab:b})},children:[e.jsxs(Z.List,{bg:"white",mb:"sm",children:[e.jsx(Z.Tab,{value:"projects",leftSection:e.jsx(co,{style:o}),children:"Allocate judges"}),e.jsx(Z.Tab,{value:"results",leftSection:e.jsx($t,{style:o}),children:"Result round 1"})]}),e.jsxs(Z.Panel,{value:"projects",children:[e.jsx(xo,{data:p??[],selection:n,setSelection:f,onHandleAllocate:()=>a(!0)}),e.jsx(io,{isOpen:c,onClose:()=>{f([]),a(!1)},judges:(p==null?void 0:p.filter(b=>n==null?void 0:n.includes(b.judge.id)).map(b=>({name:`${b.judge.firstName} ${b.judge.lastName}`})))??[],onSubmit:g,loading:u,projectIds:((X=(Q=(te=p==null?void 0:p.filter(b=>n==null?void 0:n.includes(b.judge.id)))==null?void 0:te[0])==null?void 0:Q.projects)==null?void 0:X.map(b=>b.id.toString()))??[]})]}),e.jsxs(Z.Panel,{value:"results",children:[e.jsx(fo,{data:C??[],selection:x,setSelection:S,onHandleAllocate:()=>h(!0)}),e.jsx(uo,{isOpen:y,onClose:()=>{S([]),h(!1)},projects:(C==null?void 0:C.filter(b=>x==null?void 0:x.includes(b.project.id)).map(b=>({groupName:b.project.groupName,title:b.project.title})))??[],onSubmit:$,loading:M})]})]})})};export{ko as default};
